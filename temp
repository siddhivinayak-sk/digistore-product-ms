        stage('Status Before Deployment') {
            steps {
                echo "Checking older service"
                sh(/minikube kubectl -- -n ms get all/)
                echo "Checked"
            }
        }

        stage('Clean Up') {
            steps {
                echo "Undeploying older service"
                catchError(buildResult: 'SUCCESS', stageResult: 'FAILURE') {
                   sh(/minikube kubectl -- -n ms delete -f deployment.yaml/)
                }
                echo "Undeployed"
            }
        }

        stage('Deployment') {
            steps {
                echo "Deployment Started"
                catchError(buildResult: 'SUCCESS', stageResult: 'FAILURE') {
                  sh(/minikube kubectl -- -n ms create -f deployment.yaml/)
                }
                echo "Deployment End"
            }
        }

        stage('Status') {
            steps {
                echo "Status Started"
                sh(/minikube kubectl -- -n ms get all/)
                echo "Status End"
            }
        }
